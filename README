The c# client - will need a lot of refactoring!